<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watertown SD Chamber Members - Fundraising Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c5530;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
        }
        .stats {
            text-align: center;
            color: #888;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        .stat-item {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
            border-left: 4px solid #2c5530;
        }
        .controls {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
            justify-content: space-between;
        }
        .control-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }
        .filter-control {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .filter-control label {
            font-weight: bold;
            font-size: 0.9em;
        }
        .filter-control select, .filter-control input {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 150px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
        }
        .btn-primary {
            background-color: #2c5530;
            color: white;
        }
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn:hover {
            opacity: 0.9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
            vertical-align: top;
        }
        th {
            background-color: #2c5530;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .business-name {
            font-weight: bold;
            color: #2c5530;
        }
        .contact-info {
            font-size: 0.9em;
            line-height: 1.4;
        }
        .phone {
            color: #0066cc;
        }
        .address {
            color: #666;
        }
        .category {
            font-size: 0.8em;
            color: #666;
            font-style: italic;
        }
        select, input[type="text"] {
            width: 100%;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .status-yes { background-color: #d4edda !important; }
        .status-no { background-color: #f8d7da !important; }
        .status-maybe { background-color: #fff3cd !important; }
        .status-callback { background-color: #cce7ff !important; }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 500px;
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .export-section {
            background-color: #e8f4fd;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid #2196F3;
        }
        .progress-bar {
            background-color: #e9ecef;
            border-radius: 4px;
            height: 20px;
            margin: 10px 0;
        }
        .progress-fill {
            background-color: #28a745;
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .hidden { display: none; }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            .control-group {
                justify-content: center;
            }
            .filter-control input, .filter-control select {
                width: 100%;
            }
            table {
                font-size: 0.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Watertown SD Area Chamber of Commerce</h1>
        <div class="subtitle">Member Business Fundraising Tracker</div>
        
        <div class="stats" id="statsDisplay">
            <div class="stat-item">
                <div><strong id="totalBusinesses">30</strong></div>
                <div>Total Businesses</div>
            </div>
            <div class="stat-item">
                <div><strong id="contactedCount">0</strong></div>
                <div>Contacted</div>
            </div>
            <div class="stat-item">
                <div><strong id="supportingCount">0</strong></div>
                <div>Will Support</div>
            </div>
            <div class="stat-item">
                <div><strong id="pendingCount">0</strong></div>
                <div>Pending/Follow-up</div>
            </div>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="filter-control">
                    <label>Filter by Category:</label>
                    <select id="categoryFilter">
                        <option value="">All Categories</option>
                        <option value="Automotive">Automotive</option>
                        <option value="Banking">Banking & Finance</option>
                        <option value="Construction">Construction & Remodeling</option>
                        <option value="Education">Education</option>
                        <option value="Health">Health Services</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="Professional">Professional Services</option>
                        <option value="Restaurants">Restaurants & Food</option>
                        <option value="Retail">Retail & Shopping</option>
                    </select>
                </div>
                <div class="filter-control">
                    <label>Filter by Status:</label>
                    <select id="statusFilter">
                        <option value="">All Statuses</option>
                        <option value="yes">Will Support</option>
                        <option value="no">Declined</option>
                        <option value="maybe">Considering</option>
                        <option value="callback">Needs Follow-up</option>
                        <option value="">Not Contacted</option>
                    </select>
                </div>
                <div class="filter-control">
                    <label>Search Businesses:</label>
                    <input type="text" id="searchBox" placeholder="Type business name...">
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-success" onclick="addNewBusiness()">+ Add Business</button>
                <button class="btn btn-secondary" onclick="exportData()">Export Data</button>
                <button class="btn btn-primary" onclick="importData()">Import Data</button>
            </div>
        </div>

        <div class="progress-section">
            <strong>Progress Overview:</strong>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div style="text-align: center; font-size: 0.9em; color: #666;" id="progressText">0% contacted</div>
        </div>

        <table id="businessTable">
            <thead>
                <tr>
                    <th style="width: 25%;">Business Name</th>
                    <th style="width: 25%;">Contact Information</th>
                    <th style="width: 15%;">Your Team Contact</th>
                    <th style="width: 15%;">Contact Person at Business</th>
                    <th style="width: 15%;">Support Our Fundraise?</th>
                    <th style="width: 5%;">Actions</th>
                </tr>
            </thead>
            <tbody id="businessTableBody">
                <!-- Data will be loaded here by JavaScript -->
            </tbody>
        </table>

        <div class="export-section">
            <strong>💾 Data Storage:</strong> Your data is automatically saved in your browser and will persist between sessions. 
            Use the Export button to download a backup CSV file, and Import to restore from a backup.
        </div>
    </div>

    <!-- Add Business Modal -->
    <div id="addBusinessModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Business</h3>
                <span class="close" onclick="closeModal()">&times;</span>
            </div>
            <form id="addBusinessForm">
                <div class="form-group">
                    <label>Business Name:</label>
                    <input type="text" id="newBusinessName" required>
                </div>
                <div class="form-group">
                    <label>Category:</label>
                    <select id="newBusinessCategory">
                        <option value="Professional">Professional Services</option>
                        <option value="Retail">Retail & Shopping</option>
                        <option value="Restaurants">Restaurants & Food</option>
                        <option value="Health">Health Services</option>
                        <option value="Banking">Banking & Finance</option>
                        <option value="Automotive">Automotive</option>
                        <option value="Construction">Construction & Remodeling</option>
                        <option value="Manufacturing">Manufacturing</option>
                        <option value="Education">Education</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Address:</label>
                    <input type="text" id="newBusinessAddress">
                </div>
                <div class="form-group">
                    <label>Phone:</label>
                    <input type="text" id="newBusinessPhone">
                </div>
                <div class="form-group">
                    <label>Website:</label>
                    <input type="text" id="newBusinessWebsite">
                </div>
                <div style="text-align: right; margin-top: 20px;">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                    <button type="submit" class="btn btn-success">Add Business</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initial business data
        let businessData = [
            {
                id: 1,
                name: "1st Financial Bank USA",
                category: "Banking",
                address: "500 4th St NE, Watertown, SD 57201",
                phone: "(605) 882-8800",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 2,
                name: "Ace Hardware",
                category: "Retail",
                address: "1220 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 886-3577",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 3,
                name: "Advantage Ford",
                category: "Automotive",
                address: "3520 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 886-3596",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 4,
                name: "Avera Medical Group",
                category: "Health",
                address: "901 4th St NE, Watertown, SD 57201",
                phone: "(605) 882-7000",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 5,
                name: "BankWest",
                category: "Banking",
                address: "22 1st Ave NE, Watertown, SD 57201",
                phone: "(605) 886-5911",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 6,
                name: "Bomber's Bar & Grill",
                category: "Restaurants",
                address: "1414 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 753-8921",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 7,
                name: "Butler Machinery",
                category: "Manufacturing",
                address: "2000 43rd St SE, Watertown, SD 57201",
                phone: "(605) 882-2230",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 8,
                name: "Dacotah Bank",
                category: "Banking",
                address: "15 1st Ave NE, Watertown, SD 57201",
                phone: "(605) 882-8600",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 9,
                name: "Dempsey's Brewery",
                category: "Restaurants",
                address: "122 1st Ave NE, Watertown, SD 57201",
                phone: "(605) 753-2415",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 10,
                name: "Eide Bailly LLP",
                category: "Professional",
                address: "201 1st Ave NE Ste 2, Watertown, SD 57201",
                phone: "(605) 882-5201",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 11,
                name: "Fastenal Company",
                category: "Manufacturing",
                address: "820 33rd St SE, Watertown, SD 57201",
                phone: "(605) 882-2999",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 12,
                name: "First Bank & Trust",
                category: "Banking",
                address: "1101 29th St SE, Watertown, SD 57201",
                phone: "(605) 882-4200",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 13,
                name: "Glacial Lakes Energy",
                category: "Manufacturing",
                address: "1501 8th St NE, Watertown, SD 57201",
                phone: "(605) 882-8480",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 14,
                name: "Hy-Vee",
                category: "Retail",
                address: "3620 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 882-6200",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 15,
                name: "Interstates",
                category: "Professional",
                address: "1414 4th St NE, Watertown, SD 57201",
                phone: "(605) 882-2000",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 16,
                name: "L. Marquardt Electric Inc",
                category: "Construction",
                address: "1424 7th Ave SW, Watertown, SD 57201",
                phone: "(605) 886-2107",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 17,
                name: "Lake Area Technical College",
                category: "Education",
                address: "1201 Arrow Ave, Watertown, SD 57201",
                phone: "(605) 882-5284",
                website: "www.lakeareatech.edu",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 18,
                name: "Lake Area Veterinary Clinic",
                category: "Health",
                address: "601 10th St SW, Watertown, SD 57201",
                phone: "(605) 886-5002",
                website: "www.lakeareavetclinic.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 19,
                name: "Larry's Lumber Inc",
                category: "Construction",
                address: "183 N Maple, Watertown, SD 57201",
                phone: "(605) 886-5800",
                website: "larryslumber.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 20,
                name: "Lewis Family Drug",
                category: "Health",
                address: "911 11th St SE Ste 100, Watertown, SD 57201",
                phone: "(605) 878-3072",
                website: "lewisdrug.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 21,
                name: "Les Schwab Tire",
                category: "Automotive",
                address: "828 23rd St SE, Watertown, SD 57201",
                phone: "(605) 657-1241",
                website: "lesschwab.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 22,
                name: "Lea's Hallmark",
                category: "Retail",
                address: "1300 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 753-0426",
                website: "www.hallmark.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 23,
                name: "Lakeside Pain Center",
                category: "Health",
                address: "1512 4th Street NE, Watertown, SD 57201",
                phone: "(605) 884-0100",
                website: "lakesidepain.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 24,
                name: "LiftGator",
                category: "Manufacturing",
                address: "501 Oakwood Road, Watertown, SD 57201",
                phone: "(605) 753-0919",
                website: "liftgator.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 25,
                name: "Menards",
                category: "Retail",
                address: "4000 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 882-9600",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 26,
                name: "Pizza Ranch",
                category: "Restaurants",
                address: "1510 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 882-3681",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 27,
                name: "Plains Commerce Bank",
                category: "Banking",
                address: "1420 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 882-1600",
                website: "plainscommerce.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 28,
                name: "Rising Star Hydraulics",
                category: "Manufacturing",
                address: "3501 Industrial Dr, Watertown, SD 57201",
                phone: "(605) 882-7766",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 29,
                name: "State Farm Insurance",
                category: "Professional",
                address: "201 1st Ave NE, Watertown, SD 57201",
                phone: "(605) 886-8989",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 30,
                name: "Terex Utilities",
                category: "Manufacturing",
                address: "909 6th St NE, Watertown, SD 57201",
                phone: "(605) 882-4000",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 31,
                name: "Tri-State Nursing",
                category: "Health",
                address: "1414 4th St NE Ste 7, Watertown, SD 57201",
                phone: "(605) 882-3640",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 32,
                name: "Walmart Supercenter",
                category: "Retail",
                address: "1901 9th Ave SE, Watertown, SD 57201",
                phone: "(605) 882-9100",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 33,
                name: "Watertown Regional Medical Center",
                category: "Health",
                address: "901 4th St NE, Watertown, SD 57201",
                phone: "(605) 882-7000",
                website: "watertownregional.com",
                teamContact: "",
                businessContact: "",
                status: ""
            },
            {
                id: 34,
                name: "Woods Fuller Shultz & Smith PC",
                category: "Professional",
                address: "122 1st Ave NE, Watertown, SD 57201",
                phone: "(605) 886-8726",
                website: "",
                teamContact: "",
                businessContact: "",
                status: ""
            }
        ];

        // Team members list - you can modify this
        const teamMembers = ["John", "Sarah", "Mike", "Lisa", "Alex", "Emma"];

        // Load data from storage or use default
        function loadData() {
            const stored = JSON.parse(sessionStorage.getItem('chamberBusinessData') || 'null');
            if (stored) {
                businessData = stored;
            }
        }

        // Save data to storage
        function saveData() {
            sessionStorage.setItem('chamberBusinessData', JSON.stringify(businessData));
        }

        // Generate table row HTML
        function generateTableRow(business) {
            const teamOptions = teamMembers.map(member => 
                `<option value="${member}" ${business.teamContact === member ? 'selected' : ''}>${member}</option>`
            ).join('');

            return `
                <tr class="status-${business.status}" data-category="${business.category}">
                    <td>
                        <div class="business-name">${business.name}</div>
                        <div class="category">${business.category}</div>
                    </td>
                    <td class="contact-info">
                        <div>${business.address}</div>
                        ${business.phone ? `<div class="phone">${business.phone}</div>` : ''}
                        ${business.website ? `<div><a href="http://${business.website}" target="_blank">${business.website}</a></div>` : ''}
                    </td>
                    <td>
                        <select onchange="updateField(${business.id}, 'teamContact', this.value)">
                            <option value="">Select team member...</option>
                            ${teamOptions}
                        </select>
                    </td>
                    <td>
                        <input type="text" value="${business.businessContact}" 
                               onchange="updateField(${business.id}, 'businessContact', this.value)"
                               placeholder="Enter contact name...">
                    </td>
                    <td>
                        <select onchange="updateField(${business.id}, 'status', this.value); updateRowStatus(this, this.value)">
                            <option value="" ${business.status === '' ? 'selected' : ''}>Not contacted</option>
                            <option value="yes" ${business.status === 'yes' ? 'selected' : ''}>Yes - Will support</option>
                            <option value="no" ${business.status === 'no' ? 'selected' : ''}>No - Declined</option>
                            <option value="maybe" ${business.status === 'maybe' ? 'selected' : ''}>Maybe - Considering</option>
                            <option value="callback" ${business.status === 'callback' ? 'selected' : ''}>Needs follow-up</option>
                        </select>
                    </td>
                    <td>
                        <button class="btn btn-secondary" onclick="deleteBusiness(${business.id})" style="padding: 4px 8px; font-size: 0.8em;">Delete</button>
                    </td>
                </tr>
            `;
        }

        // Update field value
        function updateField(id, field, value) {
            const business = businessData.find(b => b.id === id);
            if (business) {
                business[field] = value;
                saveData();
                updateStats();
            }
        }

        // Update row status styling
        function updateRowStatus(selectElement, status) {
            const row = selectElement.closest('tr');
            row.className = `status-${status}`;
        }

        // Render the table
        function renderTable() {
            const tbody = document.getElementById('businessTableBody');
            tbody.innerHTML = businessData.map(generateTableRow).join('');
            updateStats();
        }

        // Update statistics
        function updateStats() {
            const total = businessData.length;
            const contacted = businessData.filter(b => b.status !== '').length;
            const supporting = businessData.filter(b => b.status === 'yes').length;
            const pending = businessData.filter(b => b.status === 'maybe' || b.status === 'callback').length;
            
            document.getElementById('totalBusinesses').textContent = total;
            document.getElementById('contactedCount').textContent = contacted;
            document.getElementById('supportingCount').textContent = supporting;
            document.getElementById('pendingCount').textContent = pending;
            
            const progressPercent = total > 0 ? Math.round((contacted / total) * 100) : 0;
            document.getElementById('progressFill').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = `${progressPercent}% contacted`;
        }

        // Filter table
        function filterTable() {
            const categoryFilter = document.getElementById('categoryFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            const searchFilter = document.getElementById('searchBox').value.toLowerCase();
            const rows = document.querySelectorAll('#businessTable tbody tr');

            rows.forEach(row => {
                const category = row.getAttribute('data-category') || '';
                const businessName = row.querySelector('.business-name')?.textContent.toLowerCase() || '';
                const statusSelect = row.querySelector('select[onchange*="status"]');
                const currentStatus = statusSelect ? statusSelect.value : '';

                let showRow = true;

                if (categoryFilter && !category.toLowerCase().includes(categoryFilter.toLowerCase())) {
                    showRow = false;
                }

                if (statusFilter !== '' && currentStatus !== statusFilter) {
                    showRow = false;
                }

                if (searchFilter && !businessName.includes(searchFilter)) {
                    showRow = false;
                }

                row.style.display = showRow ? '' : 'none';
            });
        }

        // Add new business
        function addNewBusiness() {
            document.getElementById('addBusinessModal').style.display = 'block';
        }

        // Close modal
        function closeModal() {
            document.getElementById('addBusinessModal').style.display = 'none';
            document.getElementById('addBusinessForm').reset();
        }

        // Delete business
        function deleteBusiness(id) {
            if (confirm('Are you sure you want to delete this business?')) {
                businessData = businessData.filter(b => b.id !== id);
                saveData();
                renderTable();
            }
        }

        // Export data to CSV
        function exportData() {
            const headers = ['Business Name', 'Category', 'Address', 'Phone', 'Website', 'Team Contact', 'Business Contact', 'Status'];
            const csvContent = [
                headers.join(','),
                ...businessData.map(business => [
                    `"${business.name}"`,
                    `"${business.category}"`,
                    `"${business.address}"`,
                    `"${business.phone}"`,
                    `"${business.website}"`,
                    `"${business.teamContact}"`,
                    `"${business.businessContact}"`,
                    `"${business.status}"`
                ].join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `watertown-chamber-tracker-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Import data from CSV
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const csv = e.target.result;
                            const lines = csv.split('\n');
                            const headers = lines[0].split(',');
                            
                            const importedData = [];
                            for (let i = 1; i < lines.length; i++) {
                                if (lines[i].trim()) {
                                    const values = lines[i].split(',').map(v => v.replace(/"/g, ''));
                                    const business = {
                                        id: Math.max(...businessData.map(b => b.id), 0) + i,
                                        name: values[0] || '',
                                        category: values[1] || '',
                                        address: values[2] || '',
                                        phone: values[3] || '',
                                        website: values[4] || '',
                                        teamContact: values[5] || '',
                                        businessContact: values[6] || '',
                                        status: values[7] || ''
                                    };
                                    importedData.push(business);
                                }
                            }
                            
                            if (confirm(`Import ${importedData.length} businesses? This will replace your current data.`)) {
                                businessData = importedData;
                                saveData();
                                renderTable();
                                alert('Data imported successfully!');
                            }
                        } catch (error) {
                            alert('Error importing file. Please check the format.');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // Event listeners
        document.getElementById('categoryFilter').addEventListener('change', filterTable);
        document.getElementById('statusFilter').addEventListener('change', filterTable);
        document.getElementById('searchBox').addEventListener('input', filterTable);

        document.getElementById('addBusinessForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newBusiness = {
                id: Math.max(...businessData.map(b => b.id)) + 1,
                name: document.getElementById('newBusinessName').value,
                category: document.getElementById('newBusinessCategory').value,
                address: document.getElementById('newBusinessAddress').value,
                phone: document.getElementById('newBusinessPhone').value,
                website: document.getElementById('newBusinessWebsite').value,
                teamContact: '',
                businessContact: '',
                status: ''
            };

            businessData.push(newBusiness);
            saveData();
            renderTable();
            closeModal();
        });

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('addBusinessModal');
            if (event.target === modal) {
                closeModal();
            }
        });

        // Initialize the application
        function init() {
            loadData();
            renderTable();
        }

        // Start the app when page loads
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>